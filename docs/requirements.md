# 要件定義書 (Requirements Definition)

## 1. プロジェクト概要

**目的**: ブラウザ上で完結する高パフォーマンスな画像処理ツールの提供。
**コンセプト**: "Catchy & Friendly", "LINE-style Vibe", "Simple & Fast".
**ターゲットユーザー**: LINE スタンプ作成者 (クリエイター)、画像編集を手軽に行いたいユーザー。

## 2. 全体要件 (General Requirements)

### システム要件

- **プラットフォーム**: Web ブラウザ (最新の Chrome, Firefox, Safari, Edge)
- **処理方式**: クライアントサイド処理 (Canvas API)。サーバーへの画像アップロード禁止。
- **パフォーマンス**: ネットワーク遅延ゼロ、リアルタイムプレビュー。

### UI/UX デザイン

- **テーマ**: LINE ライクな明るい配色 (White/Green) をベースに、親しみやすい「カジュアル」なデザイン。
- **スタイル**: ポップでキャッチーな雰囲気を演出。ボタンやアイコンは丸みを帯びた形状 (Rounded) を採用。
- **インタラクション**: 直感的なドラッグ&ドロップ、キビキビとした動作 (Snappy response)。
- **ページ構成**:
  - **Landing Page (`/`)**: キャッチーなコピーと「始める」ボタン。アプリの魅力を伝えるイントロダクション。
  - **Web App (`/app`)**: 実際の画像処理ツール画面。
- **レイアウト (`/app`)**:
  - **Sidebar**: ツール切り替え（大きなアイコンで分かりやすく）。
  - **Main Stage**: 画像表示・操作エリア。背景は透過がわかりやすい市松模様。

## 3. 機能要件 (Functional Requirements)

### A. 背景削除 (Background Removal - Chroma Key)

特定の色を透明化し、背景を除去する機能。

| 項目 | 要件詳細 | 備考 |
|Flags|---|---|
| **入力** | 画像ファイル (PNG, JPG, WebP) | D&D またはファイル選択 |
| **色選択** | **スポイト機能**: 画像上のクリックで色を取得 <br> **手動入力**: Hex コード / RGB 値指定 | EyeDropper API (Chrome) or Canvas Click |
| **透明化処理** | 選択色と類似するピクセルを透明 (Alpha=0) にする | ユークリッド距離計算 |
| **パラメータ** | **許容値 (Tolerance)**: 色の近似範囲を調整 (スライダー) <br> **境界ぼかし (Feather)**: エッジを滑らかにする (スライダー) ※Optional | リアルタイム反映 |
| **背景色確認** | 透明部分を確認するためのチェッカーボード背景表示 | トグル切り替え可 |
| **出力** | PNG 形式 (透過保持) でダウンロード | |

### B. 画像分割 (Image Splitting - Grid Split)

画像を格子状に分割し、一括ダウンロードする機能。

| 項目             | 要件詳細                                                      | 備考                            |
| ---------------- | ------------------------------------------------------------- | ------------------------------- |
| **グリッド設定** | 行数 (Rows): 1〜5 <br> 列数 (Cols): 1〜5                      | スライダーまたは数値入力        |
| **プレビュー**   | 画像上にグリッド線をオーバーレイ表示                          | 色変更可 (視認性向上)           |
| **分割処理**     | 指定された分割数で画像をクロップし、個別の Blob を生成        | OffscreenCanvas 推奨            |
| **出力**         | すべての画像を 1 つの ZIP ファイルにまとめてダウンロード      | ライブラリ: JSZip               |
| **ファイル名**   | 規則: `{original_name}_{row}_{col}.png` (例: `image_1_1.png`) | 0-indexed or 1-indexed (要検討) |

### C. 余白カット (Edge/Margin Cutting - Crop & Trim)

画像の不要な部分を切り取る機能。

| 項目               | 要件詳細                                                                                                 | 備考                   |
| ------------------ | -------------------------------------------------------------------------------------------------------- | ---------------------- |
| **手動クロップ**   | 四隅および各辺のハンドル操作による範囲指定                                                               | 直感的な操作           |
| **数値指定**       | 上・下・左・右 のカット量をピクセル単位で指定                                                            | Input Field            |
| **自動トリミング** | コンテンツ部分 (不透明または背景色以外) のバウンディングボックスを自動検出し、クロップ枠をスナップさせる | アルゴリズム実装が必要 |
| **アスペクト比**   | 自由 / 1:1 / 4:3 / 16:9 等の固定比率 (Optional)                                                          |                        |
| **出力**           | 切り抜かれた範囲のみを画像として保存 (PNG/JPG)                                                           |                        |

### D. ランディングページ (Landing Page)

**URL**: `/`

- **目的**: ユーザーの興味を引き、アプリ利用へ誘導する。
- **コンテンツ**:
  - **Hero Section**: キャッチーなタイトルと「今すぐ作る」ボタン (`/app` へ遷移)。
  - **Features**: 背景削除、分割、カットの 3 大機能をアイコン付きで紹介。
  - **Usage**: 3 ステップで簡単作成 (Upload -> Edit -> Download) の図解。

## 4. 技術スタック要件

- **Framework**: Next.js (App Router)
- **Styling**: Tailwind CSS
- **State Management**: React Context, Hooks
- **Logic**: HTML5 Canvas API, JSZip
- **Deployment**: Cloudflare Pages (Static Export)

## 5. 今後のステップ

この要件定義に基づき、詳細設計と UI 実装へ進みます。
特に「自動トリミング」のアルゴリズム詳細と、「スポイトツール」のブラウザ互換性対応について、実装フェーズで PoC (概念実証) を行うことを推奨します。
